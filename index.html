<!DOCTYPE html>
<html lang="zxx">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="Ecommerce site">
    <meta name="keywords" content="Ecommerce, unica, creative, html">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>THRILS | Home</title>
    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@200;300;400;600;900&display=swap" rel="stylesheet">
    <!-- Css Styles -->
    <link rel="stylesheet" href="css/bootstrap.min.css" type="text/css">
    <link rel="stylesheet" href="css/font-awesome.min.css" type="text/css">
    <link rel="stylesheet" href="css/elegant-icons.css" type="text/css">
    <link rel="stylesheet" href="css/nice-select.css" type="text/css">
    <link rel="stylesheet" href="css/jquery-ui.min.css" type="text/css">
    <link rel="stylesheet" href="css/owl.carousel.min.css" type="text/css">
    <link rel="stylesheet" href="css/slicknav.min.css" type="text/css">
    <link rel="stylesheet" href="css/style.css" type="text/css">
    <script src="js/jquery-3.3.1.min.js"></script>
</head>

<body>
    <!-- Page Preloder -->
    <div id="preloder">
        <div class="loader"></div>
    </div>
    <!-- Header Section Begin -->
    <div id="header-wrapper"></div>
    <!-- Header Section End -->
    <!-- Hero Section Begin -->
    <section class="hero">
        <div class="container">
            <div class="row">
                <!-- <div class="col-lg-3">
                    <div class="hero__categories">
                        <div class="hero__categories__all">
                            <i class="fa fa-bars"></i>
                            <span>All departments</span>
                        </div>
                        <ul>
                            <li><a href="#">Fresh Meat</a></li>
                            <li><a href="#">Vegetables</a></li>
                            <li><a href="#">Fruit & Nut Gifts</a></li>
                            <li><a href="#">Fresh Berries</a></li>
                            <li><a href="#">Ocean Foods</a></li>
                            <li><a href="#">Butter & Eggs</a></li>
                            <li><a href="#">Fastfood</a></li>
                            <li><a href="#">Fresh Onion</a></li>
                            <li><a href="#">Papayaya & Crisps</a></li>
                            <li><a href="#">Oatmeal</a></li>
                            <li><a href="#">Fresh Bananas</a></li>
                        </ul>
                    </div>
                </div> -->
                <div class="col-lg-12">
                    <div class="banner-carousel owl-carousel">
                        <div class="hero__item set-bg" data-setbg="img/hero/banner.jpg">
                            <div class="hero__text">
                                <span>FRUIT FRESH DAY</span>
                                <h2>
                                    Vegetable
                                    <br> 100% Organic
                                </h2>
                                <p>Free Pickup and Delivery Available</p>
                                <a href="#" class="primary-btn">SHOP NOW</a>
                            </div>
                        </div>
                        <div class="hero__item set-bg" data-setbg="img/hero/banner3.png">
                            <div class="hero__text">
                                <span>BIG BILLION DAY</span>
                                <h2>
                                    Deals
                                    <br> of the day
                                </h2>
                                <p>Discount and Delivery Available</p>
                                <a href="#" class="primary-btn">SHOP NOW</a>
                            </div>
                        </div>
                        <div class="hero__item set-bg" data-setbg="img/hero/banner4.png">
                            <div class="hero__text">
                                <span>INDIAN SALE DAY</span>
                                <h2>
                                    Pick your
                                    <br> favourite products
                                </h2>
                                <p>Free Pickup and Delivery Available</p>
                                <a href="#" class="primary-btn">SHOP NOW</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Hero Section End -->
    <!-- Categories Section Begin -->
    <section class="categories">
        <div class="container">
            <div class="row">
                <div class="categories__slider owl-carousel"></div>
            </div>
        </div>
    </section>
    <!-- Categories Section End -->
    <!-- Featured Section Begin -->
    <section class="featured spad">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="section-title">
                        <h2>Thrils Fresh</h2>
                    </div>
                    <div class="featured__controls">
                        <ul>
                            <li class="active" data-filter="*">All</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="row featured__filter">
                <!-- Append products -->
            </div>
        </div>
    </section>
    <!-- Featured Section End -->
    <!-- Footer Section Begin -->
    <footer class="footer spad">
        <div class="container">
            <div class="row">
                <div class="col-lg-3 col-md-6 col-sm-6">
                    <div class="footer__about">
                        <div class="footer__about__logo">
                            <!-- <a href="./index.html"><img src="img/logo.png" alt=""></a> -->
                            <h3>THRILS</h3>
                        </div>
                        <ul>
                            <li>
                                Address: 4B,3rd block Aarudhra apartments , TELUNGUPALAYAM PIRIVU,coimbatore-641026
                            </li>
                            <li>Phone: +91 90438 79366</li>
                            <li>Email: thrils.india@gmail.com</li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6 col-sm-6 offset-lg-1">
                    <div class="footer__widget">
                        <h6></h6>
                        <ul>
                            <li>
                                <a href="#">About Us</a>
                            </li>
                            <li>
                                <a href="#">About Our Shop</a>
                            </li>
                            <li>
                                <a href="#">Secure Shopping</a>
                            </li>
                            <li>
                                <a href="#">Delivery infomation</a>
                            </li>
                            <li>
                                <a href="#">Privacy Policy</a>
                            </li>
                            <li>
                                <a href="#">Our Sitemap</a>
                            </li>
                        </ul>
                        <ul>
                            <li>
                                <a href="#">Who We Are</a>
                            </li>
                            <li>
                                <a href="#">Our Services</a>
                            </li>
                            <li>
                                <a href="#">Projects</a>
                            </li>
                            <li>
                                <a href="#">Contact</a>
                            </li>
                            <li>
                                <a href="#">Innovation</a>
                            </li>
                            <li>
                                <a href="#">Testimonials</a>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-4 col-md-12">
                    <div class="footer__widget">
                        <h6>Join Our Newsletter Now</h6>
                        <p>
                            Send E-mail updates about our latest shop and special offers.
                        </p>
                        <form action="#" style="display: none">
                            <input type="text" placeholder="Enter your mail">
                            <button type="submit" class="site-btn">Subscribe</button>
                        </form>
                        <a href="mailto:someone@example.com?Subject=Hello%20again" target="_top">
                            <button type="submit" class="site-btn">
                                    Keep in touch with us
                                </button>
                        </a>
                        <div class="footer__widget__social">
                            <a href="#">
                                <i class="fa fa-facebook"></i>
                            </a>
                            <a href="#">
                                <i class="fa fa-instagram"></i>
                            </a>
                            <a href="#">
                                <i class="fa fa-twitter"></i>
                            </a>
                            <a href="#">
                                <i class="fa fa-pinterest"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <div class="footer__copyright">
                        <div class="footer__copyright__text">
                            <p>
                                <!-- Link back to ecommerce can't be removed. site is licensed under CC BY 3.0. -->
                                Copyright &copy;
                                <script>
                                    document.write(new Date().getFullYear());
                                </script>
                                All rights reserved
                                <!-- Link back to ecommerce can't be removed. site is licensed under CC BY 3.0. -->
                            </p>
                        </div>
                        <div class="footer__copyright__payment">
                            <img src="img/payment-item.png" alt="">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- Footer Section End -->
    <div id="snackbar"></div>
    <!-- Js Plugins -->
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.nice-select.min.js"></script>
    <script src="js/jquery-ui.min.js"></script>
    <script src="js/jquery.slicknav.js"></script>
    <script src="js/mixitup.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/main.js"></script>
    `
    <script>
        let products = "",
            productCategory,
            categoryArray = [],
            mainCategoryArray = [];

        // $.ajax({
        //     url: "https://THRILS-mode.herokuapp.com/product/details/get",
        //     type: "GET",
        //     crossDomain: true,
        //     dataType: "JSON",
        //     beforeSend: function(xhr){
        //       xhr.setRequestHeader('Access-Control-Allow-Origin', '*')
        //       xhr.setRequestHeader('Access-Control-Allow-Methods', 'GET,POST,PUT,PATCH,DELETE,OPTIONS')
        //       xhr.setRequestHeader('Access-Control-Allow-Headers', 'Authorization,Accept-Language,Connection,Content-Type,Content-Length,Host,Origin,User-Agent')
        //     },
        //     headers: {
        //       'Access-Control-Allow-Origin': '*',
        //       'Access-Control-Allow-Methods': 'GET,POST,PUT,PATCH,DELETE,OPTIONS',
        //       'Access-Control-Allow-Headers': 'Authorization,Accept-Language,Connection,Content-Type,Content-Length,Host,Origin,User-Agent'
        //     },
        //     success: function( response ) {
        //         console.log( response ); // server response
        //     },
        //     error: function(err) {
        //       console.log(err);
        //     }
        // });
        renderProducts("");

        function renderProducts(selectedCategory) {
            
            $("#preloder").show();
            $(".loader").show();

            $(".featured__filter").children().remove();
            $(".featured__controls ul").children().remove();
            $(".featured__controls ul").append(
                `<li class="active" data-filter="*">All</li>`
            );

            $.get("http://ec2-13-58-84-7.us-east-2.compute.amazonaws.com:7071/product/details/getallproduct", function(response, status) {
                // console.log("Data: ", data);
                products = "";
                categoryArray = [];
                mainCategoryArray = [];

                let data = response.data;
                selectedCategory = selectedCategory === "" ? data[0].main_category.name : selectedCategory;

                let filteredProducts = data.filter(function(el) {
                    return el.main_category.name === selectedCategory;
                });
                mainCategoryArray.push(filteredProducts[0].main_category);

                filteredProducts.forEach((val, index) => {
                    productCategory = formatSpace(val.sub_category);
                    products += `<div class="col-lg-3 col-md-4 col-sm-6 mix ${formatSpace(
              val.product_name
            )} ${productCategory}" id="${val.product_id}">
                      <div class="featured__item">
                          <div class="featured__item__pic set-bg" style="background-image: url(${
                            val.product_image === "" || val.product_image === null
                              ? "img/placeholder.png"
                              : val.product_image
                          });" data-id="${val.product_id}" data-title="${
              val.product_name
            }" data-img="${
              val.product_image === ""
                ? "img/placeholder.png"
                : val.product_image
            }" data-desc="${val.prod_desc}" data-price="${
              val.price_per_unit
            }" data-status="${val.product_status}" data-weight="${
              val.min_range
            } ${val.quantity_unit}" data-quantity="${val.max_quantity}">
                              <ul class="featured__item__pic__hover">
                                  <li><a href="#" class="add-fav"><i class="fa fa-heart"></i></a></li>
                                  <li><a href="#" class="add-cart"><i class="fa fa-shopping-cart"></i></a></li>
                              </ul>
                          </div>
                          <div class="featured__item__text">
                              <h6><a href="#">${val.product_name}</a></h6>
                              <h5>Rs.${val.price_per_unit}</h5>
                          </div>
                      </div>
                  </div>`;

                    // sub category filteration
                    if (!categoryArray.includes(productCategory)) {
                        categoryArray.push(productCategory);
                    }
                });

                // maincategory append
                if ($(".categories__slider").html().trim() === "") {
                    data.forEach((val, index) => {
                        // main category filteration
                        if (!mainCategoryArray.some(
                                (item) => item.name === val.main_category.name
                            )) {
                            mainCategoryArray.push(val.main_category);
                        }
                    });
                    renderMainCategory(mainCategoryArray, selectedCategory);

                    $("#header-wrapper").load("header.html", function() {
                        $('.hero').css('padding-top', $('.header').height() + 30)
                        renderHamurgerCategory(mainCategoryArray, selectedCategory);
                    });
                }

                // category append
                categoryArray.forEach((val, index) => {
                    $(".featured__controls ul").append(
                        `<li data-filter=".${val}">${formatSpace(val)}</li>`
                    );
                });

                // Product append
                $(".featured__filter").append(products);

                // Plugin initialisation
                var containerEl = $(".featured__filter");
                let randomID = "MixItUp" + Math.floor(200000 + Math.random() * 30000);

                $(containerEl).attr("id", randomID);
                mixitup(containerEl);

                //Disable loader
                $(".loader").fadeOut();
                $("#preloder").delay(200).fadeOut("slow");
            });
        }

        function renderMainCategory(mainCategoryArray, selectedCategory) {
            // main category append
            let mainCatEle = "";
            $(".categories__slider").children().remove();

            console.log(mainCategoryArray);
            mainCategoryArray.forEach((val, index) => {
                mainCatEle += `<div class="col-lg-3">
                        <div class="categories__item set-bg" style="background-image: url(${
                          val.image === "" ? "img/placeholder.png" : val.image
                        })">
                            <div class="${val.name.replace(/\s/g, '')} category-border ${
                              val.name === selectedCategory ? "active" : ""
                            }"></div>
                            <h5><a href="#">${val.name}</a></h5>
                        </div>
                    </div>`;
            });
            $(".categories__slider").append(mainCatEle);

            $(".categories__slider").owlCarousel({
                // loop: true,
                margin: 0,
                items: 4,
                dots: false,
                nav: true,
                navText: [
                    "<span class='fa fa-angle-left'><span/>",
                    "<span class='fa fa-angle-right'><span/>",
                ],
                animateOut: "fadeOut",
                animateIn: "fadeIn",
                smartSpeed: 1200,
                autoHeight: false,
                // autoplay: true,
                responsive: {
                    0: {
                        items: 1,
                    },

                    480: {
                        items: 2,
                    },

                    768: {
                        items: 3,
                    },

                    992: {
                        items: 4,
                    },
                },
            });
            //Disable loader
            $(".loader").fadeOut();
            $("#preloder").delay(200).fadeOut("slow");
        }

        function renderHamurgerCategory(mainCategoryArray, selectedCategory) {

            let mainCatEle = "<p>Categories</p>";
            mainCategoryArray.forEach((val, index) => {
                mainCatEle += `<li><a href="#${val.name}" class="${val.name.replace(/\s/g, '')}">${val.name}</a></li>`
            });
            $('#main-cat').append(mainCatEle)

            $('#hr-line').append('<hr/>')
        }

        // Banner carousel
        $(".banner-carousel").owlCarousel({
            loop: true,
            margin: 0,
            items: 1,
            dots: false,
            nav: false,
            // navText: ["<span class='fa fa-angle-left'><span/>", "<span class='fa fa-angle-right'><span/>"],
            // animateOut: 'fadeOut',
            // animateIn: 'fadeIn',
            smartSpeed: 1200,
            autoHeight: false,
            autoplay: true,
        });

        $(document).on("click", ".add-fav", function(e) {
            e.preventDefault();
            showSnackBar("Product added to favourites");
        });

        $(document).on("click", ".add-cart", function(e) {
            e.preventDefault();
            showSnackBar("Selected Product added to Cart");
        });

        localStorage.setItem("checkItem", "Product");

        $(document).on(
            "click",
            ".categories__item .category-border, #main-cat li",
            function() {
                $(".categories__item .category-border").removeClass("active");
                $(this).addClass("active");

                let selectedCategory, id;

                if ($(this).parent().attr('id') === 'main-cat') {
                    selectedCategory = $(this).find("a").text();
                    id = $(this).find("a").attr('class')

                    $(".categories__item .category-border").removeClass("active");
                    $('.' + id).addClass("active");

                    $(".humberger__menu__wrapper").removeClass("show__humberger__menu__wrapper");
                    $(".humberger__menu__overlay").removeClass("active");
                    $("body").removeClass("over_hid");

                    $('html, body').animate({
                        scrollTop: $(".featured.spad").offset().top - 130
                    }, 1500);
                } else {
                    selectedCategory = $(this).siblings().find("a").text();
                }

                // Change title
                $(".section-title h2").text(selectedCategory);

                let jsonFile =
                    localStorage.getItem("checkItem") === "Product" ?
                    "Product2" :
                    "Product";
                localStorage.setItem("checkItem", jsonFile);

                renderProducts(selectedCategory);
            }
        );
    </script>
</body>

</html>